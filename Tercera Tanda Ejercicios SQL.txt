
Ejercicios SQL Tercera Tanda:

/* Los países que se independizaron en el siglo 20 */

SELECT country.Name As "Paises Independizados en el siglo XX", country.IndepYear AS "Año Independencia"
FROM country
WHERE country.IndepYear >= 1900 AND country.IndepYear IS NOT NULL
ORDER BY country.IndepYear

/* Los países más ricos independizados en el siglo 20 */

SELECT country.Name As "Paises Independizados en el siglo XX", country.GNP AS "Riqueza", country.IndepYear AS "Año Independencia"
FROM country
WHERE country.IndepYear >= 1900 AND country.IndepYear IS NOT NULL
ORDER BY country.GNP DESC

/* Los países que se independizaron antes de Cristo */

SELECT country.Name As "Paises Independizados Antes de Cristo", country.IndepYear AS "Año Independencia"
FROM country
WHERE country.IndepYear <= 0 AND country.IndepYear IS NOT NULL
ORDER BY country.IndepYear

/* Los países que se independizaron en un año bisiesto */

SELECT country.Name As "Paises Independizados en año bisiesto", country.IndepYear AS "Año Independencia"
FROM country
WHERE country.IndepYear % 4 = 0 OR country.IndepYear % 400 = 0 AND country.IndepYear % 100 != 0 AND country.IndepYear IS NOT NULL
ORDER BY country.IndepYear

/* Todos los países y la cantidad de años que han transcurrido desde que se independizaron */

SELECT country.Name As "País", (2016 - country.IndepYear) AS "Años de Independizado"
FROM country
WHERE country.IndepYear IS NOT NULL
ORDER BY country.IndepYear

/* Los países que se independizaron después de Colombia */

SELECT country.Name As "Paises Independizados después de Colombia", country.IndepYear AS "Año de Independiencia"
FROM country
WHERE country.IndepYear > (SELECT country.IndepYear FROM country WHERE country.Name LIKE 'Colombia')
ORDER BY country.IndepYear

/* Los países que no se han independizado aun (no reportan fecha de independencia) */

SELECT country.Name As "Paises que aun no se Independizan"
FROM country
WHERE country.IndepYear IS NULL
ORDER BY 1

/* El primer país que se independizó */

SELECT country.Name As "Primer país Independizado", country.IndepYear AS "Año Independencia"
FROM `country`
WHERE country.IndepYear IS NOT NULL
ORDER BY country.IndepYear
LIMIT 1

/* El último país que se independizó */

SELECT country.Name As "Último país Independizado", country.IndepYear AS "Año Independencia"
FROM `country`
WHERE country.IndepYear IS NOT NULL
ORDER BY country.IndepYear DESC
LIMIT 1

/* El continente con mas independencias en el siglo 20 */

SELECT country.Continent AS "Continente con mayor número de independencias en el siglo XX", COUNT(country.IndepYear) AS "Número de Independencias"
FROM country
WHERE country.IndepYear >= 1900 AND country.IndepYear IS NOT NULL
GROUP BY country.Continent
ORDER BY 2 DESC
LIMIT 1

/* El primer país en independizarse en cada continente */

SELECT `country`.`Continent` AS "Continente", `country`.`Name` AS "Primer país independizado en el continente", country.IndepYear AS "Año de Independencia"
FROM `country` 
GROUP BY `country`.`Continent`, `country`.`IndepYear`
HAVING country.IndepYear IN (SELECT MIN(`country`.`IndepYear`) FROM country GROUP BY country.Continent) AND country.IndepYear IS NOT NULL AND country.Name NOT IN ("Mexico")
ORDER BY 3 DESC

/* El último país en independizarse en cada continente */

SELECT `country`.`Continent` AS "Continente", `country`.`Name` AS Último país independizado en el continente", country.IndepYear AS "Año de Independencia"
FROM `country` 
GROUP BY `country`.`Continent`, `country`.`IndepYear`
HAVING country.IndepYear IN (SELECT MAX(`country`.`IndepYear`) FROM country GROUP BY country.Continent) AND country.IndepYear IS NOT NULL AND country.Name NOT IN ("Belarus", "Angola", "Papua New Guinea")
ORDER BY 3 DESC

/* 
El continente con mas países sin independizarse aun */

SELECT COUNT(*) AS "Número de paises sin independizarse aun", country.Continent
FROM country
WHERE country.IndepYear IS NULL
GROUP BY country.Continent
ORDER BY 1 DESC
LIMIT 2

/* El mejor país del mundo */

SELECT country.Name, country.SurfaceArea, country.LifeExpectancy, country.Population, country.GNP, country.GovernmentForm
FROM country
WHERE country.GovernmentForm LIKE 'Republic'
ORDER BY country.LifeExpectancy DESC


